var SC=SC||{},SC=SC||{};SC.chart||(SC.chart={}),SC.chart.pie=function(){"use strict";function t(a){t.reDrawChart(a)}function a(){function t(){var t=i.append("defs").selectAll("radialGradient").data(w(C)).enter().append("radialGradient").attr("gradientUnits","userSpaceOnUse").attr("cx",0).attr("cy",0).attr("r","50%").attr("id",function(t,a){return"grad"+a});t.append("stop").attr("offset","75%").style("stop-color",y[1]),t.append("stop").attr("offset","100%").style("stop-color",y[0]),i.selectAll("path").data(w(C)).enter().append("path").attr("fill",function(t,a){return"url(#grad"+a+")"}).attr("d",r)}function a(){l.append("div").attr("class","sc-pie-chart-keyHeader").text(e.title),l.append("div").attr("class","sc-chart-noDataMessage").text(f.noDataAvailable)}function n(t){var a=d3.interpolate({startAngle:0*Math.PI,endAngle:0*Math.PI},t);return function(t){return r(a(t))}}var r=d3.svg.arc(),d=$(s).data("chart-type")||"pie",u=$(s).data("animation-type")||"exp-in-out",o=$(s).data("animation-speed")||1200;f.HideLegend===!0?"donut"==d?r.outerRadius(c/2.5).innerRadius(c/2.5-h):"pie"==d?r.outerRadius(c/2.5).innerRadius(0):r.outerRadius(c/2.5).innerRadius(0):"donut"==d?p/2>c?r.outerRadius(c/2.5).innerRadius(c/2.5-h):p/1.5>c?r.outerRadius(c/2.75).innerRadius(c/2.75-h):r.outerRadius(p/4.5).innerRadius(c/3-h):"pie"==d?p/2>c?r.outerRadius(c/2.5).innerRadius(0):r.outerRadius(p/4.5).innerRadius(0):p/2>c?r.outerRadius(c/2.5).innerRadius(0):r.outerRadius(p/4.5).innerRadius(0);var v=void 0===e||0===e.values.length;if(v){var A=void 0!==e?e.title:"";e=R,e.title=A}var C=w(e.values);if(v)t(),a(),e=void 0;else{var m=i.selectAll(".arc").data(C).enter().append("g").attr("class","arc").each(function(t){isNaN(t.startAngle)&&(t.startAngle=0),isNaN(t.endAngle)&&(t.endAngle=0)});m.append("path").attr("d",r).style("fill",function(t,a){return v?y:g(a)}).transition().ease(u).duration(o).attrTween("d",n).style("cursor",function(t){return"other"!==t.data.url?"default":"pointer"})}}var e,n,r,i,d,s,u,o,l,c=256,p=600,h=35,f={},v=["#256194","#0494d7","#8fb7e1","#a3cf5d","#7a9900","#d00a2d","#f15c21","#fcce07","#a743b3","#593d83","#65656a","#193b53"],g=d3.scale.ordinal().range(v),y=["#ebeff2","#f5f5f5"],R={values:[{value:100}]},w=d3.layout.pie().sort(null).startAngle(0*Math.PI).endAngle(2*Math.PI).value(function(t){return t.values}),A=function(t){var a=d3.range(t.length),e=[];return a.forEach(function(a){e[a]={data:t[a]}}),e};return t.reDrawChart=function(t){u&&u.remove(),f.HideLegend===!0?n=p>c?c:p:(n=p/2>c?c:p/2,r=p-n),s=t,u=d3.select(t).append("div").attr("class","sc-pie-chart-container").attr("height",c),this.drawChart()},t.drawChart=function(){o=u.append("div").attr("class","sc-pie-chart").attr("width",n).attr("height",c),o.append("div").attr("class","sc-pie-chart-refresh-icon").style("display","none");var a=o.append("svg");return f.HideLegend!==!0?(l=u.append("div").attr("class","sc-pie-chart-key").style("width",r+"px").attr("height",c),void 0!==e&&e.values.length>0&&t.drawKey(l),t.drawPieChart(a),t):void 0},t.drawPieChart=function(t){i=t.attr("height",c).attr("width",n).append("g").attr("transform","translate("+n/2+","+c/2+")"),a()},t.drawKey=function(t){if(f.HideLegend!==!0){t.append("div").attr("class","sc-pie-chart-keyHeader").text(e.title);var a=A(e.values);d=t.append("div");var n=d.append("ul"),r=n.selectAll("li").data(a).enter().append("li").style("cursor",function(t){return"other"!==t.data.url?"default":"pointer"}),i=$(s).data("animation-type")||"exp-in-out",u=$(s).data("animation-speed")||1200,o=$(s).data("key-animation-type")||i,l=$(s).data("key-animation-speed")||u;r.append("div").transition().duration(l).ease(o).style("width","1.125em").style("height","1.125em").style("background-color",function(t,a){return v[a]});var c=r.append("div").text(function(t){return t.data.label}).style("opacity","0");c.transition().duration(l).ease(o).style("opacity","1")}},t.on=function(a,e){return e&&(i&&i.selectAll("path").on(a,e),d&&d.selectAll("li").on(a,e)),t},t.colors=function(a){return arguments.length?(v=a,g=d3.scale.ordinal().range(v),t):v},t.data=function(a){return e=a,t},t.height=function(a){return arguments.length?(a>0&&(c=a),t):c},t.width=function(a){return arguments.length?(p=a,t):p},t.updateData=function(n){return e=n,a(),t},t.options=function(a){return arguments.length?(f=$.extend(f,a),t):f},t.updateChart=function(){u&&(o&&o.remove(),l&&l.remove()),this.drawChart()},t};
